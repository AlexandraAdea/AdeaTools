{% extends 'adeazeit_base.html' %}

{% block title %}{% if object %}Aufgabe bearbeiten{% else %}Neue Aufgabe{% endif %} – AdeaZeit{% endblock %}

{% block breadcrumbs %}
<a href="{% url 'admin-dashboard' %}">Dashboard</a>
<a href="{% url 'adeazeit:task-list' %}">Aufgaben</a>
<a href="#">{% if object %}Bearbeiten{% else %}Neu{% endif %}</a>
{% endblock %}

{% block content %}
<section class="content-card">
    <div class="adea-d-flex-between">
        <div>
            <h1 style="margin-bottom: 8px;">{% if object %}Aufgabe bearbeiten{% else %}Neue Aufgabe{% endif %}</h1>
            <p class="lead">{% if object %}Bearbeite die Aufgabe "{{ object.titel }}".{% else %}Erstelle eine neue Aufgabe für deine To-Do-Liste.{% endif %}</p>
        </div>
        <a class="adea-button-secondary" href="{% url 'adeazeit:task-list' %}">Zurück zur Liste</a>
    </div>

    <form method="post" style="margin-top: 24px;">
        {% csrf_token %}
        
        {% if form.non_field_errors %}
        <div class="adea-message adea-message-error" style="margin-bottom: 20px;">
            {{ form.non_field_errors }}
        </div>
        {% endif %}

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
            <!-- Linke Spalte -->
            <div>
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="{{ form.titel.id_for_label }}" class="adea-label">
                        {{ form.titel.label }} <span style="color: #ff3b30;">*</span>
                    </label>
                    {{ form.titel }}
                    {% if form.titel.errors %}
                    <div class="adea-error-message">{{ form.titel.errors }}</div>
                    {% endif %}
                    {% if form.titel.help_text %}
                    <small class="adea-help-text">{{ form.titel.help_text }}</small>
                    {% endif %}
                </div>

                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="{{ form.client.id_for_label }}" class="adea-label">
                        {{ form.client.label }}
                    </label>
                    {{ form.client }}
                    {% if form.client.errors %}
                    <div class="adea-error-message">{{ form.client.errors }}</div>
                    {% endif %}
                    {% if form.client.help_text %}
                    <small class="adea-help-text">{{ form.client.help_text }}</small>
                    {% endif %}
                </div>

                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="{{ form.fälligkeitsdatum.id_for_label }}" class="adea-label">
                        {{ form.fälligkeitsdatum.label }}
                    </label>
                    {{ form.fälligkeitsdatum }}
                    {% if form.fälligkeitsdatum.errors %}
                    <div class="adea-error-message">{{ form.fälligkeitsdatum.errors }}</div>
                    {% endif %}
                    {% if form.fälligkeitsdatum.help_text %}
                    <small class="adea-help-text">{{ form.fälligkeitsdatum.help_text }}</small>
                    {% endif %}
                </div>
            </div>

            <!-- Rechte Spalte -->
            <div>
                {% if form.mitarbeiter %}
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="{{ form.mitarbeiter.id_for_label }}" class="adea-label">
                        {{ form.mitarbeiter.label }} <span style="color: #ff3b30;">*</span>
                    </label>
                    {{ form.mitarbeiter }}
                    {% if form.mitarbeiter.errors %}
                    <div class="adea-error-message">{{ form.mitarbeiter.errors }}</div>
                    {% endif %}
                </div>
                {% endif %}
                
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="{{ form.status.id_for_label }}" class="adea-label">
                        {{ form.status.label }}
                    </label>
                    {{ form.status }}
                    {% if form.status.errors %}
                    <div class="adea-error-message">{{ form.status.errors }}</div>
                    {% endif %}
                </div>

                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="{{ form.prioritaet.id_for_label }}" class="adea-label">
                        {{ form.prioritaet.label }}
                    </label>
                    {{ form.prioritaet }}
                    {% if form.prioritaet.errors %}
                    <div class="adea-error-message">{{ form.prioritaet.errors }}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Beschreibung (volle Breite) -->
        <div class="form-group" style="margin-bottom: 20px;">
            <label for="{{ form.beschreibung.id_for_label }}" class="adea-label">
                {{ form.beschreibung.label }}
            </label>
            {{ form.beschreibung }}
            {% if form.beschreibung.errors %}
            <div class="adea-error-message">{{ form.beschreibung.errors }}</div>
            {% endif %}
            {% if form.beschreibung.help_text %}
            <small class="adea-help-text">{{ form.beschreibung.help_text }}</small>
            {% endif %}
        </div>

        <!-- Notizen (volle Breite) -->
        <div class="form-group" style="margin-bottom: 20px;">
            <label for="{{ form.notizen.id_for_label }}" class="adea-label">
                {{ form.notizen.label }} ("Wo geblieben")
            </label>
            {{ form.notizen }}
            {% if form.notizen.errors %}
            <div class="adea-error-message">{{ form.notizen.errors }}</div>
            {% endif %}
            {% if form.notizen.help_text %}
            <small class="adea-help-text">{{ form.notizen.help_text }}</small>
            {% endif %}
        </div>

        <!-- Buttons -->
        <div style="display: flex; gap: 12px; margin-top: 32px; padding-top: 24px; border-top: 1px solid #e5e5ea;">
            <button type="submit" class="adea-button-primary">
                {% if object %}Aktualisieren{% else %}Erstellen{% endif %}
            </button>
            <a href="{% url 'adeazeit:task-list' %}" class="adea-button-secondary">Abbrechen</a>
        </div>
    </form>
</section>
{% endblock %}

