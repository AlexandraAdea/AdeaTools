{% load static %}
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}AdeaTools{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/adeastyle.css' %}">
    {% block head_extra %}{% endblock %}
</head>
<body>
    <div class="frame">
        <!-- Hauptnavigation -->
        <nav style="background: #ffffff; border-bottom: 1px solid #d2d2d7; padding: 12px 24px;">
            <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto;">
                <div style="display: flex; align-items: center; gap: 24px;">
                    <a href="{% url 'home' %}" style="font-size: 1.2em; font-weight: 600; color: #1d1d1f; text-decoration: none;">AdeaTools</a>
                    {% if user.is_authenticated %}
                    <div style="display: flex; gap: 8px;">
                        {% if perms.adeadesk.view_client or user.is_staff %}
                        <a href="{% url 'adeadesk:client-list' %}" class="adea-nav-link {% if request.path|slice:":6" == '/desk/' %}active{% endif %}">AdeaDesk</a>
                        {% endif %}
                        {% if perms.adeazeit.view_timeentry or user.is_staff %}
                        <a href="{% url 'adeazeit:timeentry-day' %}" class="adea-nav-link {% if request.path|slice:":6" == '/zeit/' %}active{% endif %}">AdeaZeit</a>
                        {% endif %}
                        {% if perms.adealohn.view_payrollrecord or user.is_staff %}
                        <a href="{% url 'adealohn:payroll-list' %}" class="adea-nav-link {% if request.path|slice:":6" == '/lohn/' %}active{% endif %}">AdeaLohn</a>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                <div style="display: flex; align-items: center; gap: 16px;">
                    {% if user.is_authenticated %}
                        <span style="color: #1d1d1f; font-weight: 500;">{{ user.get_full_name|default:user.username }}</span>
                        <form action="{% url 'global-logout' %}" method="post" style="display: inline; margin: 0;">
                            {% csrf_token %}
                            <button type="submit" style="background: #ff3b30; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">Abmelden</button>
                        </form>
                    {% endif %}
                </div>
            </div>
        </nav>
        
        <!-- Mandanten-Info für AdeaLohn -->
        {% if request.path|slice:":6" == "/lohn/" %}
        <div style="background: #f5f5f7; padding: 12px 24px; border-bottom: 1px solid #d2d2d7;">
            <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto;">
                <div>
                    {% if current_client %}
                        <strong>Mandant:</strong> {{ current_client.name }}
                        <a href="{% url 'adealohn:client_switch' %}" style="margin-left: 16px; color: #007aff; text-decoration: none;">Mandant wechseln</a>
                    {% else %}
                        <span style="color: #8e8e93;">Kein Mandant ausgewählt</span>
                        <a href="{% url 'adealohn:client_switch' %}" style="margin-left: 16px; color: #007aff; text-decoration: none;">Mandant auswählen</a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endif %}
        <main>
            <!-- Django Messages -->
            {% if messages %}
            <div style="max-width: 1400px; margin: 0 auto; padding: 12px 24px;">
                {% for message in messages %}
                <div class="adea-message adea-message-{{ message.tags }}" style="margin-bottom: 12px; padding: 12px 16px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between;">
                    <span>{{ message }}</span>
                    <button onclick="this.parentElement.style.display='none'" style="background: none; border: none; font-size: 1.2em; cursor: pointer; color: inherit; opacity: 0.7;">×</button>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% block content %}
            <section class="content-card">
                <p>Inhalt fehlt – bitte überschreiben.</p>
            </section>
            {% endblock %}
        </main>

        <footer>© 2025 AdeaTools – entwickelt für Treuhandbüro Ivanova</footer>
        {% block scripts %}{% endblock %}
    </div>
</body>
</html>

